$(document).ready(function(){$.getJSON("test.json",function(t){function i(){$(".mySlider .mainContainer").animate({"margin-left":-o},500,function(){$(".mainContainer > div:first-child").appendTo(".mySlider .mainContainer"),$(".mySlider .mainContainer").css("margin-left",0)})}function n(){$(".mySlider .mainContainer").animate({"margin-left":o},500,function(){$(".mainContainer > div:last-child").prependTo(".mySlider .mainContainer"),$(".mySlider .mainContainer").css("margin-left",0)})}for(var a=0;a<t.length;a++){var e=t[a].picture,r=t[a].name,l=t[a].author.first,d=t[a].author.last,s=t[a].price,c=t[a].discount;$(".mySlider .mainContainer").append('<div class="number'+a+'">\r\n						<div class="pic"></div>\r\n						<h1 class="name"></h1>\r\n						<p class="author"></p>\r\n						<p class="price"></p>\r\n						<p class="discount"></p>\r\n					</div>');$(".mySlider .mainContainer div:nth-child("+(a+1)+") .pic").css({height:"60%","background-image":"url("+e+")","background-repeat":"no-repeat","background-size":"100% 100%"}),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .name").text(r),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .name").addClass("nameText"),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .author").text(l+" "+d),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .author").addClass("authorText"),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .price").text("Цена: "+s+" руб."),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .price").addClass("priceText"),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .discount").text("F"==t[a].typediscount?"Скидка: "+c+" руб.":"Скидка: "+c+" %"),$(".mySlider .mainContainer div:nth-child("+(a+1)+") .discount").addClass("discountText")}var o=$(".mySlider .mainContainer > div").outerWidth(!0),m=$(".mySlider .mainContainer > div").length;$(".mySlider .mainContainer").width(o*m),$(".mySlider").css({width:3*o,overflow:"hidden"}),$(".mySlider .mainContainer").css("left",-o),$(".mainContainer > div:last-child").prependTo(".mySlider .mainContainer"),$(".mySlider .arrowRight").on("click",i),$(".mySlider .arrowLeft").on("click",n),$(".mainContainer > div").on("click",function(){var i,n,a,e,r=$(this).attr("class"),l=/number\d+/,d=r.match(l),s=d.shift(),c=s.slice(6),o=t[c].isActive,m=t[c].name,h=+t[c].price;"P"===t[c].typediscount?(i=Math.round(h*t[c].discount/100*100)/100,a=Math.round(100*(h-i))/100):"F"===t[c].typediscount&&(n=t[c].discount,e=h-n);var u,p,C;$(this).hasClass("clicked")?($(this).removeClass("clicked"),o===!0&&($(".table ."+c).remove(),"P"===t[c].typediscount?(u=parseFloat($(".table .allSum").text())-parseFloat(a),u=Math.round(100*u)/100,$(".table .allSum").text(u),p=parseFloat($(".table .allDiscount").text())-parseFloat(i),p=Math.round(100*p)/100,$(".table .allDiscount").text(p),C=parseFloat($(".table .allSumWD").text())-parseFloat(i)-parseFloat(a),C=Math.round(100*C)/100,$(".table .allSumWD").text(C)):"F"===t[c].typediscount&&(u=parseFloat($(".table .allSum").text())-parseFloat(e),u=Math.round(100*u)/100,$(".table .allSum").text(u),p=parseFloat($(".table .allDiscount").text())-parseFloat(n),p=Math.round(100*p)/100,$(".table .allDiscount").text(p),C=parseFloat($(".table .allSumWD").text())-parseFloat(n)-parseFloat(e),C=Math.round(100*C)/100,$(".table .allSumWD").text(C)),4==$(".table tr").length&&$(".table").css("display","none"))):($(this).addClass("clicked"),o===!0&&($(".table").css("display","block"),"P"===t[c].typediscount?($(".table tr:first-child").after('<tr class="'+c+'">\r\n								<td>'+m+"</td><td>"+a+" руб.</td>\r\n							</tr>"),""==$(".table .allSum").text()?(u=0,u+=a,$(".table .allSum").text(u),p=0,p+=i,$(".table .allDiscount").text(p),C=0,C=C+i+a,$(".table .allSumWD").text(C)):(u=parseFloat($(".table .allSum").text())+parseFloat(a),u=Math.round(100*u)/100,$(".table .allSum").text(u),p=parseFloat($(".table .allDiscount").text())+parseFloat(i),p=Math.round(100*p)/100,$(".table .allDiscount").text(p),C=parseFloat($(".table .allSumWD").text())+parseFloat(i)+parseFloat(a),C=Math.round(100*C)/100,$(".table .allSumWD").text(C))):($(".table tr:first-child").after('<tr class="'+c+'">\r\n								<td>'+m+"</td><td>"+e+" руб.</td>\r\n							</tr>"),""==$(".table .allSum").text()?(u=0,u+=e,$(".table .allSum").text(u),p=0,p+=n,$(".table .allDiscount").text(p),C=0,C=C+n+e,$(".table .allSumWD").text(C)):(u=parseFloat($(".table .allSum").text())+parseFloat(e),u=Math.round(100*u)/100,$(".table .allSum").text(u),p=parseFloat($(".table .allDiscount").text())+parseFloat(n),p=Math.round(100*p)/100,$(".table .allDiscount").text(p),C=parseFloat($(".table .allSumWD").text())+parseFloat(n)+parseFloat(e),C=Math.round(100*C)/100,$(".table .allSumWD").text(C)))))})})});
